<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Extension Test Page</title>
  </head>
  <body>
    <h1>Extension Test Page</h1>
    <p>This page is for testing the Job Application Helper extension.</p>

    <!-- Sample form to trigger extension -->
    <form id="testForm">
      <div>
        <label for="firstName">First Name:</label>
        <input type="text" id="firstName" name="firstName" />
      </div>
      <div>
        <label for="lastName">Last Name:</label>
        <input type="text" id="lastName" name="lastName" />
      </div>
      <div>
        <label for="email">Email:</label>
        <input type="email" id="email" name="email" />
      </div>
      <div>
        <label for="phone">Phone:</label>
        <input type="tel" id="phone" name="phone" />
      </div>
      <button type="submit">Submit</button>
    </form>

    <div style="margin-top: 20px">
      <h3>Extension Debug</h3>
      <button onclick="testExtension()">Test Extension Functions</button>
      <button onclick="enableLocalLLM()">Enable Local LLM</button>
      <div
        id="debugOutput"
        style="
          margin-top: 10px;
          padding: 10px;
          background: #f0f0f0;
          font-family: monospace;
        "
      ></div>
    </div>

    <script>
      function log(message) {
        const output = document.getElementById("debugOutput");
        output.innerHTML += message + "<br>";
        console.log(message);
      }

      function testExtension() {
        log("üß™ Testing Extension...");

        // Check if extension functions are available
        if (typeof checkAIStatus === "function") {
          log("‚úÖ Extension loaded successfully");
          try {
            checkAIStatus();
          } catch (error) {
            log("‚ùå checkAIStatus error: " + error.message);
          }
        } else {
          log("‚ùå Extension not loaded or content script not injected");
        }
      }

      function enableLocalLLM() {
        log("üîß Enabling Local LLM...");

        if (typeof chrome !== "undefined" && chrome.storage) {
          chrome.storage.sync.set(
            {
              useLocalLLM: true,
              localURL: "http://localhost:11434/api/chat",
              localModel: "deepseek-r1:latest",
            },
            function () {
              if (chrome.runtime.lastError) {
                log(
                  "‚ùå Configuration failed: " + chrome.runtime.lastError.message
                );
                return;
              }
              log("‚úÖ Local LLM configuration saved!");

              // Verify
              chrome.storage.sync.get(
                ["useLocalLLM", "localURL", "localModel"],
                function (result) {
                  log("üìÅ Verified config: " + JSON.stringify(result));
                }
              );
            }
          );
        } else {
          log("‚ùå Chrome storage API not available");
        }
      }

      // Auto-test when page loads
      setTimeout(testExtension, 1000);
    </script>
  </body>
</html>
